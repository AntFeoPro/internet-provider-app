name: Deploy Provider PWA

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Create PWA files
      run: |
        # –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è PWA
        mkdir -p public
        
        # –°–æ–∑–¥–∞–µ–º –≥–ª–∞–≤–Ω—É—é HTML —Å—Ç—Ä–∞–Ω–∏—Ü—É
        cat > public/index.html << 'EOF'
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ü—Ä–æ–≤–∞–π–¥–µ—Ä - –ë—ã—Å—Ç—Ä—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –≤—Å–µ—Ö</title>
    <meta name="description" content="–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –¥–ª—è —á–∞—Å—Ç–Ω—ã—Ö –¥–æ–º–æ–≤, –º–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã—Ö –¥–æ–º–æ–≤ –∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üåê</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .app-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .section {
            margin: 30px 0;
        }
        
        .section-title {
            color: #3498db;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .tariff-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
            transition: transform 0.3s ease;
        }
        
        .tariff-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .tariff-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .tariff-icon {
            font-size: 1.5rem;
            margin-right: 15px;
        }
        
        .tariff-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .tariff-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #27ae60;
            text-align: right;
            flex-grow: 1;
        }
        
        .tariff-features {
            list-style: none;
        }
        
        .tariff-features li {
            padding: 8px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .tariff-features li:last-child {
            border-bottom: none;
        }
        
        .contact-info {
            background: #e8f4fc;
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
        }
        
        .contact-icon {
            font-size: 1.2rem;
            margin-right: 15px;
            width: 30px;
            text-align: center;
        }
        
        .pay-button {
            display: block;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 30px 0;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(39, 174, 96, 0.3);
        }
        
        .pay-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(39, 174, 96, 0.4);
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .app-card {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="app-card">
            <div class="header">
                <div class="logo">üåê</div>
                <h1>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ü—Ä–æ–≤–∞–π–¥–µ—Ä</h1>
                <p class="subtitle">–°–∫–æ—Ä–æ—Å—Ç–Ω–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –¥–æ–º–∞ –∏ –±–∏–∑–Ω–µ—Å–∞</p>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Ç–∞—Ä–∏—Ñ–æ–≤ -->
            <div class="section">
                <h2 class="section-title">üìä –ù–∞—à–∏ —Ç–∞—Ä–∏—Ñ—ã</h2>
                
                <div class="tariff-card">
                    <div class="tariff-header">
                        <div class="tariff-icon">üè†</div>
                        <div class="tariff-name">–ß–∞—Å—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä</div>
                        <div class="tariff-price">500 ‚ÇΩ/–º–µ—Å</div>
                    </div>
                    <ul class="tariff-features">
                        <li>‚úì –°–∫–æ—Ä–æ—Å—Ç—å –¥–æ 100 –ú–±–∏—Ç/—Å</li>
                        <li>‚úì –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫</li>
                        <li>‚úì –ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</li>
                        <li>‚úì –ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</li>
                    </ul>
                </div>

                <div class="tariff-card">
                    <div class="tariff-header">
                        <div class="tariff-icon">üè¢</div>
                        <div class="tariff-name">–ú–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–π –¥–æ–º</div>
                        <div class="tariff-price">700 ‚ÇΩ/–º–µ—Å</div>
                    </div>
                    <ul class="tariff-features">
                        <li>‚úì –°–∫–æ—Ä–æ—Å—Ç—å –¥–æ 200 –ú–±–∏—Ç/—Å</li>
                        <li>‚úì IP-—Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ –≤ –ø–æ–¥–∞—Ä–æ–∫</li>
                        <li>‚úì Wi-Fi —Ä–æ—É—Ç–µ—Ä –≤ –∞—Ä–µ–Ω–¥—É</li>
                        <li>‚úì –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞</li>
                    </ul>
                </div>

                <div class="tariff-card">
                    <div class="tariff-header">
                        <div class="tariff-icon">üíº</div>
                        <div class="tariff-name">–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞</div>
                        <div class="tariff-price">2000 ‚ÇΩ/–º–µ—Å</div>
                    </div>
                    <ul class="tariff-features">
                        <li>‚úì –°–∫–æ—Ä–æ—Å—Ç—å –¥–æ 500 –ú–±–∏—Ç/—Å</li>
                        <li>‚úì –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP</li>
                        <li>‚úì –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è</li>
                        <li>‚úì –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</li>
                    </ul>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ -->
            <div class="section">
                <h2 class="section-title">üìû –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                <div class="contact-info">
                    <div class="contact-item">
                        <div class="contact-icon">üìû</div>
                        <div>+7 (123) 456-78-90</div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">‚úâÔ∏è</div>
                        <div>support@provider.ru</div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">üè†</div>
                        <div>–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1</div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">üïí</div>
                        <div>–ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                    </div>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã -->
            <a href="https://payberry.ru" class="pay-button" target="_blank">
                üí≥ –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ —á–µ—Ä–µ–∑ Payberry
            </a>

            <div class="footer">
                <p>¬© 2024 –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ü—Ä–æ–≤–∞–π–¥–µ—Ä. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                <p>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞: –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ</p>
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ—Å—Ç–æ–π PWA —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => console.log('SW registered'))
                .catch(error => console.log('SW registration failed'));
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Å—Ç–∞–ª–ª-–ø—Ä–æ–º–ø—Ç –¥–ª—è PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });
    </script>
</body>
</html>
EOF

        # –°–æ–∑–¥–∞–µ–º manifest.json
        cat > public/manifest.json << 'EOF'
{
    "name": "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ü—Ä–æ–≤–∞–π–¥–µ—Ä",
    "short_name": "–ü—Ä–æ–≤–∞–π–¥–µ—Ä",
    "description": "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—É—Å–ª—É–≥–∞–º–∏",
    "start_url": "/",
    "display": "standalone",
    "background_color": "#667eea",
    "theme_color": "#764ba2",
    "orientation": "portrait",
    "categories": ["business", "utilities"],
    "icons": [
        {
            "src": "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üåê</text></svg>",
            "sizes": "192x192",
            "type": "image/svg+xml"
        }
    ]
}
EOF

        # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π service worker
        cat > public/sw.js << 'EOF'
const CACHE_NAME = 'provider-app-v1';
const urlsToCache = [
  '/',
  '/index.html',
  '/manifest.json'
];

self.addEventListener('install', event => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache => cache.addAll(urlsToCache))
  );
});

self.addEventListener('fetch', event => {
  event.respondWith(
    caches.match(event.request)
      .then(response => response || fetch(event.request))
  );
});
EOF

        # –°–æ–∑–¥–∞–µ–º README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
        cat > public/README.md << 'EOF'
# üåê –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ü—Ä–æ–≤–∞–π–¥–µ—Ä–∞

–≠—Ç–æ Progressive Web App (PWA) –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- üìä –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- üìû –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- üí≥ –û–ø–ª–∞—Ç–∞ —É—Å–ª—É–≥ —á–µ—Ä–µ–∑ Payberry
- üì± –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫–∞–∫ PWA

## –ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í –º–µ–Ω—é –±—Ä–∞—É–∑–µ—Ä–∞ –≤—ã–±–µ—Ä–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"
3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–∞–∫ –æ–±—ã—á–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## –¢–∞—Ä–∏—Ñ—ã:
- üè† –ß–∞—Å—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä: 500 —Ä—É–±/–º–µ—Å
- üè¢ –ú–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–π –¥–æ–º: 700 —Ä—É–±/–º–µ—Å  
- üíº –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞: 2000 —Ä—É–±/–º–µ—Å
EOF

        echo "‚úÖ PWA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ!"
      
    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./public
        force_orphan: true
        
    - name: Upload as artifact
      uses: actions/upload-artifact@v4
      with:
        name: provider-pwa
        path: public/
        retention-days: 30
