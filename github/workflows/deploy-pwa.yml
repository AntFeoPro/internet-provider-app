name: Deploy Provider PWA to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: Setup Pages
      uses: actions/configure-pages@v4
    
    - name: Create PWA files
      run: |
        mkdir -p _site
        
        # –°–æ–∑–¥–∞–µ–º –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        cat > _site/index.html << 'EOF'
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ü—Ä–æ–≤–∞–π–¥–µ—Ä</title>
    <link rel="manifest" href="manifest.json">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f0f8ff; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2196F3; }
        .tariff { background: #e3f2fd; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .contact { margin: 5px 0; }
        .pay-button { background: #4caf50; color: white; padding: 15px; text-align: center; border-radius: 5px; text-decoration: none; display: block; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåê –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ü—Ä–æ–≤–∞–π–¥–µ—Ä</h1>
        
        <h2>üìä –¢–∞—Ä–∏—Ñ—ã</h2>
        <div class="tariff">
            <h3>üè† –ß–∞—Å—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä</h3>
            <p>‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: 100 –ú–±–∏—Ç/—Å - 500 —Ä—É–±/–º–µ—Å</p>
        </div>
        <div class="tariff">
            <h3>üè¢ –ú–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–π –¥–æ–º</h3>
            <p>‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: 200 –ú–±–∏—Ç/—Å - 700 —Ä—É–±/–º–µ—Å</p>
        </div>
        <div class="tariff">
            <h3>üíº –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞</h3>
            <p>‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: 500 –ú–±–∏—Ç/—Å - 2000 —Ä—É–±/–º–µ—Å</p>
        </div>

        <h2>üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
        <p class="contact">üìû –¢–µ–ª–µ—Ñ–æ–Ω: +7 (123) 456-78-90</p>
        <p class="contact">‚úâÔ∏è Email: support@provider.ru</p>
        <p class="contact">üè† –ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1</p>

        <a href="https://payberry.ru" class="pay-button" target="_blank">
            üí≥ –û–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ Payberry
        </a>
    </div>
</body>
</html>
EOF

        # –°–æ–∑–¥–∞–µ–º manifest
        cat > _site/manifest.json << 'EOF'
{
    "name": "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ü—Ä–æ–≤–∞–π–¥–µ—Ä",
    "short_name": "–ü—Ä–æ–≤–∞–π–¥–µ—Ä",
    "start_url": "/",
    "display": "standalone",
    "background_color": "#2196F3",
    "theme_color": "#2196F3"
}
EOF

        echo "‚úÖ PWA —Å–æ–∑–¥–∞–Ω–æ!"
    
    - name: Upload artifact
      uses: actions/upload-pages-artifact@v3
      with:
        path: ./_site

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
