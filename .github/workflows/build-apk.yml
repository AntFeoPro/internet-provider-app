name: Build Android APK

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Android SDK
      uses: android-actions/setup-android@v3
      with:
        api-level: 34
        build-tools: 34.0.0
        
    - name: Check app structure
      run: |
        echo "üìÅ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É app/..."
        find app/ -type f -name "*.xml" | head -10
        echo ""
        echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ app/:"
        ls -la app/
        echo ""
        echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ app/src/:"
        ls -la app/src/ || echo "–ü–∞–ø–∫–∞ src –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
        
    - name: Build test
      run: |
        cd app
        if [ -f "AndroidManifest.xml" ]; then
          echo "‚úÖ AndroidManifest.xml –Ω–∞–π–¥–µ–Ω!"
        else
          echo "‚ùå AndroidManifest.xml –ù–ï –Ω–∞–π–¥–µ–Ω –≤ app/"
          find . -name "AndroidManifest.xml" | head -5
        fi
